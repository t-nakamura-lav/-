<div class="container">
  <div class="row">
    <div class="col-md-2 text-center" style="margin: 30px 0 35px 0;">
      <h5 style="background-color: #eeeeee;">tweet投稿詳細</h5>
    </div>
  </div>

  <div class="row">
    <div class="col-md-2 text-center">
      <%= link_to user_path(@tweet.user) do %>
        <%= attachment_image_tag @tweet.user, :profile_image, :fill, 100, 100, format: 'jpeg',fallback: "no_image.jpg" %>
      <% end %>
    </div>

    <div class="col-md-10 text-center">
      <table class='table table-borderless'>
        <thead>
          <tr>
            <th><%= link_to @tweet.user.name, user_path(@tweet.user) %></th>
            <th><%= @tweet.created_at.strftime('%Y/%m/%d %H:%M') %></th>
          </tr>
        </thead>

        <tbody>
          <tr>
            <td><%= @tweet.challenge %></td>
            <td><%= @tweet.hour_attribute %>時間　<%= @tweet.minute_attribute %>分</td>
          </tr>
        </tbody>

        <tbody>
          <tr>
            <td colspan="2"><%= @tweet.tweet %></td>
          </tr>
        </tbody>

        <tbody>
          <tr>
            <td colspan="2">
              <% if @tweet.images.attached? %>
                <% @tweet.images.each do |image| %>
                  <%= image_tag image.variant(resize:'300x300') %>
                <% end %>
              <% end %>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="row">
    <div class="col-md-12 text-center">
       <% if @tweet.liked_by?(current_user) %>
        <p>
          <%= link_to tweet_likes_path(@tweet), method: :delete do %>
            ♥<%= @tweet.likes.count %> いいね
          <% end %>
        </p>
        <% else %>
        <p>
          <%= link_to tweet_likes_path(@tweet), method: :post do %>
            ♡<%= @tweet.likes.count %> いいね
          <% end %>
        </p>
      <% end %>
      コメント件数：<%= @tweet.comments.count %>

      <% @tweet.comments.each do |comment| %>
      <table class='table'>
        <tr>
          <td>
            <%= link_to user_path(comment.user) do %>
              <%= attachment_image_tag(comment.user, :profile_image, :fill, 50, 50, format: 'jpeg',fallback: "no_image.jpg") %>
              <%= comment.user.name %>
          </td>
          <td>
              <%= comment.created_at.strftime('%Y/%m/%d') %>
          </td>
          <td>
              <%= comment.comment %>
            <% end %>
          </td>
          <td>
             <% if comment.user == current_user %>
            <div class="comment-delete">
              <%= link_to "削除", tweet_comment_path(comment.tweet, comment), method: :delete %>
            </div>
            <% end %>
          </td>
        </tr>
      </table>
      <% end %>

      <div class="new-comment">
        <%= form_with(model:[@tweet, @comment], local: true) do |f| %>
          <%= f.text_area :comment, rows:'5', cols:'80',placeholder: "コメントをここに" %>
          <%= f.submit "送信する" %>
        <% end %>
      </div>
    </div>
  </div>
</div>




